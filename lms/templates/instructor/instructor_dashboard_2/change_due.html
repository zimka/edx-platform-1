<%page args="section_data" expression_filter="h"/>
<%!
from django.utils.translation import ugettext as _
from openedx.core.djangolib.markup import HTML
%>

<div class="vert-left section-change-due" id="section-change-due">
  <div class="request-response msg msg-confirm copy" id="request-response"></div>
  <div class ="change-due-disclaimer
    % if section_data['changed_due_turned_on']:
      hidden
    % endif
       ">
      ${_("Feature INDIVIDUAL_DUE_DATES is turned off. Your changes won't affect due's till feature activation. Please contact support.")}
   <hr/>
  </div>
  <div>
    <h3 class="hd hd3">${_("Description")}</h3>
    <p>  ${_("Here you can change due dates.")} </p>
    <p>
        ${_("You should choose to whom to change dues (user or cohort), to which courseware to change due (some block or the whole course) and how to change dues (just add days for current deadline or to set new deadline date) ")}
    </p>
  </div>
  <form id="form-change-due" action="${ section_data['change_due_submit_url'] }" method="post">
    <ul class="list-fields">
      <li class="field change-due-who">
        <div class="change-due-options">
          <label class="change-due-options-first"><input name="who" type="radio" value="user">${_("User")}</label>
          <label for="cohort"><input name="who" type="radio" value="cohort">${_("Cohorts")}</label>
        </div>
        <div class="change-due-cohort">
          <fieldset>
          <legend class="sr">${_("Cohorts")}</legend>
          %if len(section_data['cohorts']) > 0:
            <div class="cohort-management-nav-form-select field field-select">
              <label for="cohort-select" class="label sr">Select a cohort to manage</label>
              <select class="input cohort-select" name="cohort" id="cohort-select">
              %for cohort in section_data['cohorts']:
                <option value="${cohort.name}" id="target_cohort_${cohort.id}">
                  ${_("Cohort") +": "+ cohort.name}
                </option>
              %endfor
              </select>
            </div>
            %else:
              <p>${_("To use this option you should setup cohorts at first.")}</p>
            %endif
          </fieldset>
        </div>
        <div class="change-due-user">
          <label>
            <input type="text" id="change-due-user-name" name="user-name" maxlength="20" placeholder="${_("Username")}">
          </label>
        </div>
      </li>
      <li class="field change-due-where">
        <div class="change-due-options">
          <label class="change-due-options-first"><input name="where" type="radio" value="course">${_("Course")}</label>
          <label><input name="where" type="radio" value="block">${_("Block")}</label>
        </div>
        <div id="change-due-location" >
          <input type="text" name="location" maxlength="128" placeholder="${_("Problem location")}">
        </div>
      </li>
      <li class="field change-due-when">
        <div class="change-due-options">
          <label class="change-due-options-first"><input name="when" type="radio" value="add">${_("Add days")}</label>
          <label><input name="when" type="radio" value="set">${_("Set date")}</label>
        </div>
        <div class="change-due-add">
          <label>
            <input type="text" id="change-due-input-add-date" name="add-days" maxlength="128" placeholder="${_("E.g: 7")}">
          </label>
        </div>
        <div class="change-due-set">
          <label>
            <input type="text" id="change-due-input-set-date" name="set-date" maxlength="10" placeholder="${_("E.g. 2017/01/31")}">
          </label>
        </div>
      </li>
    </ul>
    <br />
    <input type="hidden" name="csrfmiddlewaretoken" value="${ csrf_token }">
    <input type="button" id="change-due-button" name="send" value="${_("Submit Change Due")}">
  </form>
  <div class="request-response-message hidden"> ${_("Success")} </div>

  <div class="request-response-error"></div>


  <div id="change-due-tasks">
      <input type="button" name="send" value="${_("Show Change Due Tasks")}"
             data-endpoint="${section_data['change_due_tasks_url'] }">
      <table class="change-due-table">
      </table>
  </div>
</div>

<%block name="header_extras">
  <style>
    .change-due-options{
      padding: 2em 0 0 0;
    }
    .section-change-due input[type="radio"]{
      vertical-align: baseline;
    }
    .section-change-due label{
      margin: 0 1em 0 0;
    }
    .section-change-due .change-due-options-first{
      float:left;
    }
    #change-due-location .blocked{
      background-color: #efefef;
    }
    .change-due-disclaimer{
      color: red;
    }
    table.change-due-table {
        width: 100%;
        table-layout: fixed;
        text-align: center;
        border: 1px solid black;
    }

    .change-due-table th {
        border: 1px solid black;
    }
    .change-due-table td{
        word-wrap:break-word;
        border: 1px solid black;
        vertical-align: middle;
    }
  </style>
</%block>
